<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Справочник по ЭРА</title>
<LINK REL="stylesheet" MEDIA="screen" TYPE="text/css" HREF="css.css">
<style type="text/css">
/*  these classes are for ERM code examples    */
.erm-container	{margin: 0;
		 padding: 0;
		 border: 0;
		 background-color: #d4d0c8;
		 }

.erm-code	{line-height: 1;
 		 font: 10pt monospace, Courier New;
		 color: black;
		 white-space: pre-wrap;
		 list-style: none;
		 padding: 0; margin: 5 0 10;
		 }

.erm-line	{background-color: #c6b7a4}
.erm-trigger	{color: red; font-weight:  bold}
.erm-cmd	{color: purple; font-weight:  bold}
.erm-posttrigger{color: teal; font-weight:  bold}
.erm-var,
.erm-flag	{color: navy}
.erm-comment	{color: green;letter-spacing: -0.5px}
.erm-string	{color: maroon}
.erm-instr	{color: olive; font-weight: bold}
</style>
</head>


<body background="../Img/logo/intile.jpg">

<p align="center"><span style="font:bold 24 serif">Новые события (триггеры)</span></p>

<div id="content">
<table style="width: 100%">
<tr>
		<td class="auto-style6" style="width: 32px">
		<img height="24" src="images/go_24.png" width="24" /></td>
		<td class="auto-style16"><a href="#1" name="events" class="auto-style8" style="font-weight:bolder"
		onclick="var div = this.parentNode.getElementsByTagName('div')[0]; if(div.style.display != '') { div.style.display = ''; this.innerHTML = 'Расширенные стандартные события «', title='Скрыть';}else{ div.style.display = 'none'; this.innerHTML = 'Расширенные стандартные события »', title='Показать';} return false">
		Расширенные стандартные события &raquo;</a>
		<div style="display: none; vertical-align: bottom;">
			<span style="">
			<DIV 
            style="PADDING-LEFT: 1em; PADDING-RIGHT: 1.5em; MARGIN-BOTTOM: 1em; BACKGROUND: no-repeat 2.2em center; COLOR: #444444; margin-top: 0.5em;">
				<ul>
					<li><a href="#1.1">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="19" style="BACKGROUND-IMAGE: none; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; BACKGROUND-ATTACHMENT: scroll; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND-REPEAT: repeat; BACKGROUND-POSITION: 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">!?GM1</font></font></a></li>
					<li>
					<a href="#1.2">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="20" style="BACKGROUND-IMAGE: none; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; BACKGROUND-ATTACHMENT: scroll; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND-REPEAT: repeat; BACKGROUND-POSITION: 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">!?MM0</font></font></a></li>
				</ul>
			</DIV>
			</span>
		</td>
</tr>
<tr>
		<td class="auto-style6" style="width: 32px">
		<img height="24" src="images/go_24.png" width="24" /></td>
		<td class="auto-style16"><a href="#2" name="trigger" class="auto-style8" style="font-weight:bolder"
		onclick="var div = this.parentNode.getElementsByTagName('div')[0]; if(div.style.display != '') { div.style.display = ''; this.innerHTML = 'Новые ЕРМ триггеры «', title='Скрыть';}else{ div.style.display = 'none'; this.innerHTML = 'Новые ЕРМ триггеры »', title='Показать';} return false">
		Новые ЕРМ триггеры &raquo;</a>
		<div style="display: none; vertical-align: bottom;">
			<span style="">
			<DIV 
            style="PADDING-LEFT: 1em; PADDING-RIGHT: 1.5em; MARGIN-BOTTOM: 1em; BACKGROUND: no-repeat 2.2em center; COLOR: #444444; margin-top: 0.5em;">
				<ul>
					<li><a href="#2.1">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="19" style="BACKGROUND-IMAGE: none; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; BACKGROUND-ATTACHMENT: scroll; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND-REPEAT: repeat; BACKGROUND-POSITION: 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">Запись данных в сохранение</font></font></a></li>
					<li><a href="#2.2">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="20" style="BACKGROUND-IMAGE: none; BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; BACKGROUND-ATTACHMENT: scroll; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND-REPEAT: repeat; BACKGROUND-POSITION: 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">Загрузка данных из сохранения</font></font></a></li>
					<li><a href="#2.3">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="21" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">Нажатие клавиши</font></font></a></li>
					<li><a href="#2.4">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="31" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">Открытие окна героя</font></font></a></li>
					<li><a href="#2.5">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="21" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">Закрытие окна героя</font></font></a></li>
					<li><a href="#2.6">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="31" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">Отряд получает ход в бою</font></font></a></li>
					<li><a href="#2.7">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="31" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">Фаза регенерации в бою</font></font></a></li>
					<li><a href="#2.8">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="31" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">После сохранения игры</font></font></a></li>
					<li><a href="#2.9">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="31" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">До взаимодействия героя с героем</font></font></a></li>
					<li><a href="#2.10">
					<font style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">
					<font closure_uid_4xilc2="31" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; OUTLINE-STYLE: none; OUTLINE-COLOR: invert; PADDING-LEFT: 0px; OUTLINE-WIDTH: 0px; PADDING-RIGHT: 0px; DISPLAY: inline; BACKGROUND: none transparent scroll repeat 0% 0%; FONT-SIZE: 100%; VERTICAL-ALIGN: baseline; BORDER-TOP: 0px; BORDER-RIGHT: 0px; PADDING-TOP: 0px">После взаимодействия героя с героем</font></font></a></li>
				</ul>
			</DIV>
		</span>
	</td>
</tr>
<tr>
	<td class="auto-style6" style="width: 32px">
		<img height="24" src="images/go_24.png" width="24" /></td>
		<td class="auto-style16"><a href="../Cont/LogicEvent.htm" class="auto-style8" style="font-weight:bolder">Логика срабатывания событий и некоторых хуков &raquo;</a>
	</td>
</tr>
</table>
</div>



<p class="Info-1">Новые события вводятся в игру не в виде 
привычных ЕРМ триггеров вида <span class="code">!?XX</span>, а в виде 
нестандартных номеров функций <span class="code">&gt; 30000</span>.<br>
Эра резервирует для своих нужд функции с номерами <span class="code">
77000..77999</span>. Скриптописцы и создатели плагинов могут использовать 
значения в диапазоне <span class="code">40000..134217727</span>. Была убрана 
привязка к диапазону <span class="code">0..30000</span> для ЕРМ функций.<br>
Номера для именованных ф-ций создаются и назначаются автоматически, всегда уникальные.<br>
Функции кроме <span class="code">1..30000</span> должны быть только именованные для максимальной совместимости. Эра автоматически выделяет свободные ID именованным функциям.<br>
<br>
Все новые события обладают набором из 16 локальных (неизменяемых, повторно 
генерируемыми событиями) параметров. Доступ к параметрам осуществляется 
посредством команды <span class="code">SN:X</span>.</p>

<a name="1" href="#0">
<h2>Расширенные стандартные события &uarr;</h2></a>
<p class="txt-3-Paragraph">Расширенные стандартные события также обладают 
собственными <span class="code">SN:X</span> параметрами и дополнительными 
возможностями.</p>
<p class="txt-3-Paragraph">&nbsp;</p>
<h3><a href="#events" name="1.1">!?GM1 ^</a></h3>
<p class="txt-3-Paragraph-h3"><em>Параметры:<span class="codeStd">
</span></em>Имя 
сохранения.</p>
<p class="txt-3-Paragraph"><strong>Пример:</strong></p>
<script type="erm">!?GM1;
!!SN:X?z1; получили имя сохраняемой игры
!!VRz1:+^_%Gc^; добавили к нему цвет текущего игрока
!!SN:Xz1; установили новое имя сохранения</script>
<p class="txt-3-Paragraph-h3">Если красный игрок выбрал <span class="code">newgame</span>, то игра будет сохранена в файл: 
<span class="code">&quot;newgame_Красный.gm1&quot;</span>.</p>

<h3><a href="#events" name="1.2">!?MM0 ^</a></h3>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em><br>
1: Номер текущего отряда или -1.<br>
2: Номер вражеского отряда, на который наведён курсор или -1.<br>
3: Минимальный урон.<br>
4: Максимальный урон.</p>
<p class="txt-3-Paragraph-h3">Триггер удобен для замены стандартной подсказки на 
расширенную с указанием, сколько единиц противника будет убито при ударе.</p>
<p class="txt-3-Paragraph"><strong>Пример</strong><strong class="auto-style10">:</strong></p>
<script type="erm">!?MM;
!!SN:X?y1/?y2/?y3/?y4; получили параметры события
!!FU&y2=-1:E; вышли, если это не подсказка об уроне
!!BMy2:H?y5 L?y6 N?y7; y5 - жизнь, y6 - потерянное здоровье, y7 - количество единиц противника
!!VRy8:Sy5-y6; y8 - здоровье последней единицы отряда
!!VRy9:Sy3:y5; y9 - минимальное количество, умрут
!!VRy10:Sy3%y5; y10 - урон по последней единице в худшем случае
!!VRy9&y10>=y8:+1; y9 - минимальное количество, умрут
!!VRy11:Sy4:y5; y11 - максимальное количество, умрут
!!VRy12:Sy4%y5; y12 - урон по последней единице в лучшем случае
!!VRy11&y12>=y8:+1; y11 - максимальное количество, умрут
!!VRy13:Sy5*y7-y6; y13 - общее количество здоровья отряда
!!VRy9&y9>y7:Sy7; y9 - минимальное количество, умрут
!!VRy11&y11>y7:Sy7; y11 - максимальное количество, умрут
!!IF:V2/0;
!!IF&y9=y11:V2/1; флаг 2 говорит о том, что минимальный и максимальный уроны совпадают
!!IF:V3/0;
!!IF&y9=y7:V3/1; флаг 3 говорит о том, что весь отряд по-любому умрёт
!!VRz2:S^%Y3-%Y4^; урон в формате "минимальный - максимальный"
!!VRz2&y3=y4:S^%Y3^; урон в формате "урон"
!!VRz3:S^Damage:^;
!!if&3:; если весь отряд умрёт
!!VRz1:S^%Z3 %Z2. {~Yellow}FATALITY{~}^;
!!el:;
!!VRz1:S^%Z3 %Z2. Kills: {~Yellow}%Y9-%Y11{~}^; урон с разбросом
!!VRz1&2:S^%Z3 %Z2. Kills: {~Yellow}%Y9{~}^; урон без разброса
!!en:;
!!MM:Mz1; установить новую подсказку</script>
<p class="txt-3-Paragraph"></p>
<h2><a name="2" href="#0">Новые ЕРМ триггеры &uarr;</a></h2>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.1">Запись данных в сохранение ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77001;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> нет.</p>
<p class="txt-3-Paragraph-h3">В этом событии возможна запись пользовательских 
данных в файловые секции при помощи машинной функции <span class="code">
&quot;WriteSavegameSection&quot;</span>. Все ЕРМ переменные к этому моменту уже сохранены.</p>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.2">Загрузка данных из сохранения ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77002;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> нет.</p>
<p class="txt-3-Paragraph-h3">В этом событии возможно чтение пользовательских 
данных из файловых секций при помощи машинной функции <span class="code">
&quot;ReadSavegameSection&quot;</span>. Все ЕРМ переменные к этому моменту уже загружены.</p>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.3">Нажатие клавиши ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77003;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> Код клавиши, Блокировать 
обработку игрой? (0 - нет, 1 - да).</p>
<p class="Comment-warning">Для определения того, в каком окне мы сейчас 
находимся, служит функция <span class="code">GetGameState</span><strong>.<br>
<br>
</strong>Поскольку данное событие возникает во всех игровых диалогах, не 
рекомендуется использовать общие глобальные переменные между показами диалогов, 
так как событие из диалога может их испортить.</p>
<p class="txt-3-Paragraph"><strong>Пример:</strong></p>
<script type="erm">!?FU77003; нажатие клавиши
!!SN:X?y1; y1 - код клавиши
!!FU&y1<>83:E; выйти, если код не 83 (клавиша "S")
!!SN:L^Era.dll^/?y2; получили описатель библиотеки ERA в y2
!!SN:Ay2/^GetGameState^/?y3; y3 - адрес функции GetGameState
!!SN:Ey3/1/?y4; y4 - ID родительского диалога, y5 - текущего
!!FU&y5<>4205280:E; выйти, если это не карта приключений
!!SN:X?y1/1; блокировать стандартное действие
!!IF:M^К сожалению, сохранение в данный момент невозможно^;</script>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.4">Открытие окна героя ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77004;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> нет.</p>
<p class="txt-3-Paragraph-h3">Работает синтаксис <span class="code">!!HE-1</span>.</p>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.5">Закрытие окна героя ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77005;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> нет.</p>
<p class="txt-3-Paragraph-h3">Работает синтаксис <span class="code">!!HE-1</span>.</p>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.6">Отряд получает ход в бою ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77006;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> Сторона (0 - левая, 1 - правая), 
Номер отряда (0..21).</p>
<p class="txt-3-Paragraph"><strong>Пример:</strong></p>
<script type="erm">!?FU77006;
!!SN:X0/0; в бою только первый отряд героя будет получать право хода</script>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.7">Фаза регенерации в бою ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77007;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> Номер отряда (0..41), Указатель 
на структуру <span class="code">TBattleMonster</span>, Блокировать регенерацию? 
(0 - нет, 1 - да).<br>
В этом событии происходит регенерация: <em>адских гидр</em>, <em>троллей</em>, 
<em>духов</em>.</p>
<p class="txt-3-Paragraph"><strong>Пример:</strong></p>
<script type="erm">!?FU77007;
!!SN:X?y1; y1 - номер отряда
!!FU&y1>21:E; вышли, если это защитники
!!BMy1:M41/999/3; наложить экспертное благословение на отряд, теперь все отряды атакующего всегда имеют экспертное благословение</script>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.8">После сохранения игры ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77008;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> нет.</p>
<p class="txt-3-Paragraph"><strong>Пример:</strong></p>
<script type="erm">!?FU77008;
!!IF:M^Теперь, когда игра сохранена, предлагаю вам выключить компьютер и отдохнуть^;
!!UN:C0/4/0; вызвать крах игры</script>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.9">До взаимодействия героя с героем ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77010;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> Номер героя-инициатора, номер 
героя-цели.<br>
Взаимодействие может быть встречей героев игрока, союзных героев, или нападением 
на противника.</p>
<p class="txt-3-Paragraph"></p>
<h3><a href="#trigger" name="2.10">После взаимодействия героя с героем ^</a></h3>
<p class="txt-3-Paragraph-h3"><span class="code">!?FU77011;</span></p>
<p class="txt-3-Paragraph-h3"><em>Параметры:</em> Номер героя-инициатора, номер 
героя-цели.</p>

<script src="../erm.js"></script></body></html>
